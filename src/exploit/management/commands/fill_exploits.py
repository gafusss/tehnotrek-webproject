# coding=utf-8

import uuid
import random

import datetime

from django.contrib.auth import get_user_model
from django.core.management import BaseCommand
from exploit.models import Post, ExploitType, Tag


class Command(BaseCommand):
    def handle(self, *args, **options):
        for i in range(100):
            e = Post()
            e.title = u'Название {}'.format(i)
            if (bool(random.getrandbits(1))):
                e.cve_id = None
            else:
                e.cve_id = "{}-{}".format(random.randrange(1000, 10000), random.randrange(1000, 10000))
            e.code = "Sample code {}".format(i)
            if (bool(random.getrandbits(1))):
                e.description = None
            else:
                e.description = "Sample description {}".format(i)

            # e.attachment_file

            e.exploit_type = random.choice(list(ExploitType.objects.all()))
            e.platform = random.choice(Post.PLATFORM_CHOICES)[0]
            e.author = random.choice(list(get_user_model().objects.all()))
            e.confirmed = bool(random.getrandbits(1))

            n = random.randrange(0, 20)
            tags = list(Tag.objects.all())
            e.tags = random.sample(tags, n)
            e.save()
