# coding=utf-8

import uuid
import random

import datetime

from django.contrib.auth import get_user_model
from django.core.management import BaseCommand
from exploit.models import Post, ExploitType, Tag


class Command(BaseCommand):
    def handle(self, *args, **options):
        exploit_types = list(ExploitType.objects.all())
        users = list(get_user_model().objects.all())
        tags = list(Tag.objects.all())
        for i in range(100):
            e = Post()
            e.title = u'Название {}'.format(i)
            e.cve_id = "{}-{}".format(random.randrange(1000, 10000), random.randrange(1000, 10000))
            e.code = "Sample code {}".format(i)
            e.description = "Sample description {}".format(i)

            # e.attachment_file
            e.attachment_file = "uploads/f65e891f-600f-4feb-9f17-bc94c29e54f3_expl.py"

            e.exploit_type = random.choice(exploit_types)
            e.platform = random.choice(Post.PLATFORM_CHOICES)[0]
            e.author = random.choice(users)
            e.confirmed = bool(random.getrandbits(1))

            n = random.randrange(0, 20)
            e.save()
            e.tags = random.sample(tags, n)
