{% extends "core/base.html" %}

{% load static %}

{% block head %}
<link href="{% static 'exploit/post.css' %}" rel="stylesheet">
<script type="text/javascript" src="{% static 'core/core.js' %}"></script>
<script type="text/javascript" src="{% static 'exploit/rate.js' %}"></script>
<script src="//cdn.jsdelivr.net/sockjs/1.0.3/sockjs.min.js" type="text/javascript"></script>
<script src="{% static 'exploit/centrifuge.js' %}"></script>
<script type="text/javascript" src="{% static 'exploit/comment.js' %}"></script>
{% endblock %}

{% block title %}<h1>{{ object.title }}</h1>{% endblock %}

{% block content %}
{% if object.author == user %}
<br><a href="{% url 'exploit:post_edit' pk=object.pk %}">Редактировать</a>
{% endif %}
<table id="exploit_info">
    <tr>
        <td><strong>CVE-ID: </strong>{% if object.cve_id %}CVE-{{ object.cve_id }}{% else %}нет{% endif %}</td>
        <td><strong>Подтверждён: </strong>{% if object.confirmed %}<span class="span-exploit-confirmed">&#x2713;</span>{% else %}<span class="span-exploit-not-confirmed">&#x274c;</span>{% endif %}</td>
        <td id="td-exploit-rating">{% include 'exploit/rating.html' %}</td>
    </tr>
    <tr>
        <td><strong>Скачать: </strong><a id="a-exploit-file" href="{{object.attachment_file.url}}">ссылка</a></td>
        <td><strong>Тип: </strong>{{object.exploit_type.title}}</td>
        <td><strong>Платформа: </strong>{{object.get_platform_display}}</td>
    </tr>
    <tr>
        <td><strong>Автор: </strong>{{object.author}}</td>
        <td><strong>Дата публикации: </strong>{{object.published}}</td>
        <td><strong>Дата изменения: </strong>{{object.modified}}</td>
    </tr>
    {% if object.tags.all %}
    <tr>
        <td colspan="3">
            <strong>Теги: </strong>{% for tag in object.tags.all %}{{tag.title}}{% if not forloop.last %}, {% endif %}{% endfor %}
        </td>
    </tr>
    {% endif %}
</table>
{% if object.description %}
<section id="div-exploit-description">
    <header>
        <strong>Описание:</strong>
    </header>
    <span id="span-exploit-description">{{object.description}}</span>
</section>
{% endif %}
<section id="div-exploit-code">
    <header>
        <strong>Код:</strong>
    </header>
    <code id="code-exploit-code">{{object.code}}</code>
</section>
<h2>Комментарии:</h2>
<section id="section-comments">
    {% include 'exploit/comments.html' %}
</section>
{% endblock %}
